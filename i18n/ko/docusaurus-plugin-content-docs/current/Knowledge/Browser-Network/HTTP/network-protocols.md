---
id: network-protocols
title: "\U0001F4C4 네트워크 프로토콜"
slug: /network-protocols
---

## 1. TCP, HTTP, HTTPS, WebSocket을 설명해주세요

1. **TCP (전송 제어 프로토콜)**:
   TCP는 인터넷에서 두 컴퓨터 간에 데이터를 안정적으로 전송하기 위한 신뢰할 수 있는 연결 지향 프로토콜입니다. 데이터 패킷의 순서와 신뢰성을 보장하며, 이는 네트워크 상태에 관계없이 데이터가 완전하게 목적지에 도달한다는 것을 의미합니다.

2. **HTTP (하이퍼텍스트 전송 프로토콜)**:
   HTTP는 하이퍼텍스트(즉, 웹 페이지)를 전송하기 위한 프로토콜입니다. TCP 프로토콜 위에 구축되어 브라우저와 서버 간의 통신 방법을 제공합니다. HTTP는 무상태(stateless)이며, 이는 서버가 사용자에 관한 어떤 정보도 저장하지 않는다는 것을 의미합니다.

3. **HTTPS (보안 하이퍼텍스트 전송 프로토콜)**:
   HTTPS는 HTTP의 보안 버전입니다. SSL/TLS 프로토콜을 통해 HTTP 데이터 전송을 암호화하여 교환되는 데이터의 보안을 보호하고, 중간자 공격을 방지하며, 데이터의 기밀성과 무결성을 보장합니다.

4. **WebSocket**:
   WebSocket 프로토콜은 클라이언트와 서버 간에 지속적인 연결을 설정하는 방법을 제공하며, 연결이 설정된 후 양방향으로 실시간 데이터 전송이 가능합니다. 이는 매 전송마다 새로운 연결을 설정해야 하는 전통적인 HTTP 요청과 다릅니다. WebSocket은 인스턴트 메시징과 빠른 데이터 업데이트가 필요한 애플리케이션에 더 적합합니다.

## 2. Three Way Handshake란 무엇인가요?

3방향 핸드셰이크는 `TCP/IP` 네트워크에서 서버와 클라이언트 간에 연결을 설정하는 과정을 말합니다. 이 과정에서 세 단계를 거쳐 양측의 수신 및 송신 능력이 정상인지 확인하고, 초기 시퀀스 번호(ISN)를 통해 데이터의 동기화와 보안을 보장합니다.

### TCP Message Type

단계를 이해하기 전에, 각 유형의 메시지가 어떤 주요 기능을 하는지 알아야 합니다.

| Message | Description                                            |
| ------- | ------------------------------------------------------ |
| SYN     | 연결을 시작하고 설정하며, 장치 간 시퀀스 번호 동기화에 도움 |
| ACK     | 상대방에게 SYN을 수신했음을 확인                         |
| SYN-ACK | 동기화 확인, 자신의 SYN을 보내면서 ACK도 전송            |
| FIN     | 연결 종료                                               |

### Steps

1. 클라이언트가 서버와 연결을 시작하고 SYN 메시지를 보내, 서버에 통신을 시작할 준비가 되었음과 자신이 보낸 시퀀스 번호를 알립니다.
2. 서버가 SYN 메시지를 수신한 후, 클라이언트에 응답을 준비합니다. 수신한 SYN 시퀀스 번호에 +1을 하여 ACK로 반환하고, 동시에 서버 자체의 SYN 메시지도 보냅니다.
3. 클라이언트가 서버의 응답을 확인하고, 양측 모두 안정적인 연결이 설정되어 데이터 전송을 시작합니다.

### Example

Host A가 서버에 TCP SYN 데이터를 보내며, 여기에는 임의의 시퀀스 번호가 포함됩니다. 여기서는 1000으로 가정합니다.

```bash
Host A ===(SYN=1000)===> Server
```

Server는 Host A가 보낸 시퀀스 번호에 대해 응답해야 하므로, 시퀀스 번호에 +1을 하고 자체 SYN도 보냅니다.

```bash
Host A <===(SYN=2000 ACK=1001)=== Server
```

Host A가 Server의 SYN을 수신한 후, 확인 시퀀스 번호를 보내 응답합니다. Server가 보낸 시퀀스 번호에 +1을 합니다.

```bash
Host A ===(ACK=2001)===> Server
```

### 2번의 핸드셰이크만으로도 가능한가요?

1. 3방향 핸드셰이크의 목적은 클라이언트와 서버 양측의 송수신 능력이 정상인지 확인하는 것입니다. 2번의 핸드셰이크만으로는 서버가 클라이언트의 수신 능력을 판단할 수 없습니다.
2. 세 번째 핸드셰이크가 없으면, 클라이언트가 서버의 시퀀스 번호를 수신할 수 없으므로 확인을 보낼 수도 없어, 데이터의 보안성에 의문이 생길 수 있습니다.
3. 약한 네트워크 환경에서는 데이터 도착 시간에 차이가 있을 수 있습니다. 신구 데이터의 도착 순서가 뒤바뀌면, 세 번째 핸드셰이크의 SYN 확인 없이 연결이 설정되면 네트워크 오류가 발생할 수 있습니다.

### ISN이란 무엇인가요?

ISN은 Initial Sequence Number의 약자로, 수신 측에 발신 측이 데이터를 보낼 때의 시퀀스 번호를 알려줍니다. 이것은 무작위로 동적 생성되는 시퀀스 번호로, 제3자의 침입 시 시퀀스 번호를 추측하여 메시지를 위조하는 것을 방지합니다.

### 3방향 핸드셰이크에서 데이터 전송은 언제 시작되나요?

첫 번째와 두 번째 핸드셰이크의 목적은 양측의 송수신 능력을 확인하는 것이므로 데이터를 전송할 수 없습니다. 첫 번째 핸드셰이크에서 데이터 전송이 가능하다면, 악의적인 제3자가 대량의 가짜 데이터를 전송하여 서버가 메모리 공간을 캐싱에 소비하게 만들어 공격의 기회를 줄 수 있습니다.

세 번째 핸드셰이크에서만, 양측이 동기화 확인을 완료하고 연결 상태에 있으므로 데이터 전송이 허용됩니다.

### Reference

- [TCP 3-Way Handshake (SYN, SYN-ACK,ACK)](https://www.guru99.com/tcp-3-way-handshake.html)
- [TCP 3-way 핸드셰이크 상세 분석](https://www.eet-china.com/mp/a44399.html)

## 3. HTTP 캐싱 메커니즘을 설명해주세요

HTTP 캐싱 메커니즘은 HTTP 프로토콜에서 웹 페이지 데이터를 임시 저장(또는 "캐시")하는 기술로, 서버 부담을 줄이고 지연을 낮추며 웹 페이지 로딩 속도를 높이는 것을 목적으로 합니다. 주요 캐싱 전략은 다음과 같습니다:

1. **강력한 캐시(Freshness)**: `Expires` 또는 `Cache-Control: max-age` 응답 헤더를 설정하여, 특정 시간 내에 데이터를 최신 상태로 간주할 수 있으며, 클라이언트가 서버에 확인하지 않고 직접 사용할 수 있습니다.

2. **검증 캐시(Validation)**: `Last-Modified`와 `ETag` 응답 헤더를 사용하여, 클라이언트가 서버에 조건부 요청을 보낼 수 있으며, 데이터가 수정되지 않았으면 304(Not Modified) 상태 코드를 반환하여 로컬 캐시 데이터를 사용할 수 있음을 나타냅니다.

3. **협상 캐시(Negotiation)**: 이 방식은 `Vary` 응답 헤더에 의존하며, 서버가 클라이언트의 요청(예: `Accept-Language`)에 따라 다른 버전의 캐시 콘텐츠를 제공할지 결정합니다.

4. **캐시 안 함(No-store)**: `Cache-Control: no-store`가 설정된 경우, 데이터가 캐시되어서는 안 되며, 매번 요청 시 서버에서 최신 데이터를 가져와야 합니다.

캐싱 전략의 선택은 데이터 유형과 업데이트 빈도 등의 요소에 따라 결정되며, 효과적인 캐싱 전략은 네트워크 애플리케이션의 성능을 크게 향상시킬 수 있습니다.

### Service Worker

개인적인 경험으로, Web App에 PWA를 설정한 후, 기본 스타일이나 로고, 심지어 오프라인용 offline.html을 service-worker.js에 등록할 수 있습니다. 이렇게 하면 고객이 오프라인 상태에서도, 이 캐시 메커니즘을 통해 현재 웹사이트나 네트워크 상태를 알 수 있으며, 일정 수준의 사용자 경험을 유지할 수 있습니다.
